var jsonData = [
        {
        "id": "38172",
        "employee_name": "test23",
        "employee_salary": "20",
        "employee_age": "10",
        "profile_image": ""
        },
        {
        "id": "38173",
        "employee_name": "bhat54434",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38174",
        "employee_name": "ss1234",
        "employee_salary": "333",
        "employee_age": "33",
        "profile_image": ""
        },
        {
        "id": "38185",
        "employee_name": "test123",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38188",
        "employee_name": "testresult",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38193",
        "employee_name": "ssss",
        "employee_salary": "2123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38196",
        "employee_name": "testhansraajwww",
        "employee_salary": "0",
        "employee_age": "0",
        "profile_image": ""
        },
        {
        "id": "38200",
        "employee_name": "test12345",
        "employee_salary": "123",
        "employee_age": "24",
        "profile_image": ""
        },
        {
        "id": "38201",
        "employee_name": "",
        "employee_salary": "0",
        "employee_age": "0",
        "profile_image": ""
        },
        {
        "id": "38202",
        "employee_name": "btf1244g",
        "employee_salary": "11223",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38203",
        "employee_name": "user2",
        "employee_salary": "254",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38204",
        "employee_name": "user3",
        "employee_salary": "254",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38205",
        "employee_name": "bhat5444",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38206",
        "employee_name": "Amlslyeggst",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38207",
        "employee_name": "user4",
        "employee_salary": "254",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38208",
        "employee_name": "tJJKKJJest",
        "employee_salary": "1212321323",
        "employee_age": "45",
        "profile_image": ""
        },
        {
        "id": "38209",
        "employee_name": "testvishal",
        "employee_salary": "9634",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38210",
        "employee_name": "AAAAAAA",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38211",
        "employee_name": "Ram11",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38212",
        "employee_name": "bhat54",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38214",
        "employee_name": "Ram20",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38215",
        "employee_name": "bhat44",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38216",
        "employee_name": "test4",
        "employee_salary": "1234",
        "employee_age": "123",
        "profile_image": ""
        },
        {
        "id": "38218",
        "employee_name": "test5",
        "employee_salary": "1234",
        "employee_age": "123",
        "profile_image": ""
        },
        {
        "id": "38219",
        "employee_name": "BBBBB",
        "employee_salary": "1230",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38172",
        "employee_name": "test23",
        "employee_salary": "20",
        "employee_age": "10",
        "profile_image": ""
        },
        {
        "id": "38173",
        "employee_name": "bhat54434",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38174",
        "employee_name": "ss1234",
        "employee_salary": "333",
        "employee_age": "33",
        "profile_image": ""
        },
        {
        "id": "38185",
        "employee_name": "test123",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38188",
        "employee_name": "testresult",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38193",
        "employee_name": "ssss",
        "employee_salary": "2123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38196",
        "employee_name": "testhansraajwww",
        "employee_salary": "0",
        "employee_age": "0",
        "profile_image": ""
        },
        {
        "id": "38200",
        "employee_name": "test12345",
        "employee_salary": "123",
        "employee_age": "24",
        "profile_image": ""
        },
        {
        "id": "38201",
        "employee_name": "",
        "employee_salary": "0",
        "employee_age": "0",
        "profile_image": ""
        },
        {
        "id": "38202",
        "employee_name": "btf1244g",
        "employee_salary": "11223",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38203",
        "employee_name": "user2",
        "employee_salary": "254",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38204",
        "employee_name": "user3",
        "employee_salary": "254",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38205",
        "employee_name": "bhat5444",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38206",
        "employee_name": "Amlslyeggst",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38207",
        "employee_name": "user4",
        "employee_salary": "254",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38208",
        "employee_name": "tJJKKJJest",
        "employee_salary": "1212321323",
        "employee_age": "45",
        "profile_image": ""
        },
        {
        "id": "38209",
        "employee_name": "testvishal",
        "employee_salary": "9634",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38210",
        "employee_name": "AAAAAAA",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38211",
        "employee_name": "Ram11",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38212",
        "employee_name": "bhat54",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38214",
        "employee_name": "Ram20",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38215",
        "employee_name": "bhat44",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38216",
        "employee_name": "test4",
        "employee_salary": "1234",
        "employee_age": "123",
        "profile_image": ""
        },
        {
        "id": "38218",
        "employee_name": "test5",
        "employee_salary": "1234",
        "employee_age": "123",
        "profile_image": ""
        },
        {
        "id": "38219",
        "employee_name": "BBBBB",
        "employee_salary": "1230",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38172",
        "employee_name": "test23",
        "employee_salary": "20",
        "employee_age": "10",
        "profile_image": ""
        },
        {
        "id": "38173",
        "employee_name": "bhat54434",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38174",
        "employee_name": "ss1234",
        "employee_salary": "333",
        "employee_age": "33",
        "profile_image": ""
        },
        {
        "id": "38185",
        "employee_name": "test123",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38188",
        "employee_name": "testresult",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38193",
        "employee_name": "ssss",
        "employee_salary": "2123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38196",
        "employee_name": "testhansraajwww",
        "employee_salary": "0",
        "employee_age": "0",
        "profile_image": ""
        },
        {
        "id": "38200",
        "employee_name": "test12345",
        "employee_salary": "123",
        "employee_age": "24",
        "profile_image": ""
        },
        {
        "id": "38201",
        "employee_name": "",
        "employee_salary": "0",
        "employee_age": "0",
        "profile_image": ""
        },
        {
        "id": "38202",
        "employee_name": "btf1244g",
        "employee_salary": "11223",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38203",
        "employee_name": "user2",
        "employee_salary": "254",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38204",
        "employee_name": "user3",
        "employee_salary": "254",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38205",
        "employee_name": "bhat5444",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38206",
        "employee_name": "Amlslyeggst",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38207",
        "employee_name": "user4",
        "employee_salary": "254",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38208",
        "employee_name": "tJJKKJJest",
        "employee_salary": "1212321323",
        "employee_age": "45",
        "profile_image": ""
        },
        {
        "id": "38209",
        "employee_name": "testvishal",
        "employee_salary": "9634",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38210",
        "employee_name": "AAAAAAA",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38211",
        "employee_name": "Ram11",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38212",
        "employee_name": "bhat54",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38214",
        "employee_name": "Ram20",
        "employee_salary": "123",
        "employee_age": "23",
        "profile_image": ""
        },
        {
        "id": "38215",
        "employee_name": "bhat44",
        "employee_salary": "123",
        "employee_age": "25",
        "profile_image": ""
        },
        {
        "id": "38216",
        "employee_name": "test4",
        "employee_salary": "1234",
        "employee_age": "123",
        "profile_image": ""
        },
        {
        "id": "38218",
        "employee_name": "test5",
        "employee_salary": "1234",
        "employee_age": "123",
        "profile_image": ""
        },
        {
        "id": "38219",
        "employee_name": "BBBBB",
        "employee_salary": "1230",
        "employee_age": "23",
        "profile_image": ""
        }
]

var data = createId(jsonData);
var header = [];
var page_span = document.getElementById("page");

// Creating table format
var table = document.createElement("table");
table.setAttribute("id", "myTable");

// Creating table contents
var thead = table.createTHead();
var tr = thead.insertRow();
var tbody = table.createTBody();

// Display data
var divContainer = document.getElementById("showData");
divContainer.appendChild(table);

// Search Function
var results = [];

var called = false;

var currentPage = 1;
var recordsPerPage = 10;


window.onload = function() {
    changePage(1);
};



/**
 * changePage is a function which decides on which page to jump.
 * @param {page} page is the current page number.
 */

 // Pagination
 function changePage(page){
    var btn_next = document.getElementById("btn_next");
    var btn_prev = document.getElementById("btn_prev");

    validatingPage(page);
   

    if(!called){
        createTableData(data,page);
    } else {
        createTableData(results,page);
    }
    
    page_span.innerHTML = page + "/" + totalPages();

    toggleVisibility(page);

}


/**
 * validatingPage is a function which validates the page jump.
 * @param {page} page is current page number.
 */

 // Validation of page
 function validatingPage(page){
    if (page < 1) {
        page = 1;
    }
    if (page > totalPages()) {
        page = totalPages();
    }
}


/**
 * createTableData is a function that creates the table after any search is done.
 * @param {arr} arr is an array of matching searched contents, using which the table after searching is formed.
 * @param {currenPage} currentPage is a number that defines the current working page.
 */
function createTableData(arr,currentPage) {
    tbody.innerHTML = ""
    for(let i = (currentPage-1)*recordsPerPage; i < (currentPage*recordsPerPage); i++){
        tr = tbody.insertRow();
        if(arr[i]) {
            for(let heading of header) {
                let tablecell = tr.insertCell();
                tablecell.innerHTML = arr[i][heading];
            }
        }
    }
}




/**
 * toggleVisibility is a function which controls the visibility of next and previous button
 * @param {page} page is current page number. 
 */

function toggleVisibility(page) {
    if (page == 1) {
        btn_prev.style.visibility = "hidden";
    } else {
        btn_prev.style.visibility = "visible";
    }

    if (page == totalPages()) {
        btn_next.style.visibility = "hidden";
    } else {
        btn_next.style.visibility = "visible";
    }
}


// Checking for actions of previous button
function previousPage() {
    if(currentPage > 1){
        currentPage--;
        changePage(currentPage);
    }
}

// Checking for actions of next button
function nextPage(){
    if(currentPage < totalPages()){
        currentPage++;
        changePage(currentPage);
    }
}

// Showing the number of total pages
function totalPages(){
    if(!called){
        return Math.round(data.length / recordsPerPage);
    }else{
        return Math.round(results.length / recordsPerPage);
    }
}


extractHeader();
headerFormat();


/**
 * extractHeader extract the header from array of objects for Table
 */

// Extracting Header

function extractHeader(){
    for (var i = 0; i < data.length; i++) {
        for (var key in data[i]){
            if (header.indexOf(key) == -1) {
                header.push(key);
            }
        }            
    }
}


/**
 * headerFormat function removes the underscore and capitalize the words in it.
 */

// Changing Header Format
function headerFormat(){
    for (var i = 0; i < header.length; i++){
        var th = document.createElement("th");
        var th_old = header[i].charAt(0).toUpperCase() + header[i].slice(1);
        th.innerHTML = th_old.replace(/_/g, " ");
        tr.appendChild(th);
    }
}



/**
 * createId generates Id no. for Id column instead of random unique numbers
 * @param {json}  json is an array of objects in which Id section is generated
 */

// Creating Ids
function createId(json) {
    var data = [];
    var index = 1;
    
    for(let obj of json) {
        obj.id = index;
        data.push(obj);
        index++;
    }
    return data;
}



/**
 * search function handles the searching part of the application
 */

//Search Function
function search() {

    called = true;
    results = [];

    var input = document.getElementById("myInput");
    var filter = input.value.toUpperCase();
    
    for(let obj of data) {
        if(obj.employee_name.toUpperCase().indexOf(filter)!=-1) {
            results.push(obj);
            console.log(results);
        }
    }
    if(results) {
        called = true;
        page_span.innerHTML = currentPage + "/" + totalPages();
        createTableData(results,currentPage);
        currentPage = 1;

        toggleVisibility(currentPage);
    }
}


